const _0x1e3c1b=_0xebc0;(function(_0x5078f8,_0xc8b5b8){const _0x58dcb=_0xebc0,_0x525ce3=_0x5078f8();while(!![]){try{const _0x54281e=-parseInt(_0x58dcb(0xc4))/0x1*(-parseInt(_0x58dcb(0x101))/0x2)+parseInt(_0x58dcb(0xdb))/0x3+-parseInt(_0x58dcb(0xe8))/0x4*(parseInt(_0x58dcb(0xe0))/0x5)+-parseInt(_0x58dcb(0xe1))/0x6*(-parseInt(_0x58dcb(0xfb))/0x7)+-parseInt(_0x58dcb(0xa2))/0x8*(parseInt(_0x58dcb(0xa3))/0x9)+-parseInt(_0x58dcb(0xcb))/0xa+parseInt(_0x58dcb(0xb6))/0xb*(-parseInt(_0x58dcb(0xd7))/0xc);if(_0x54281e===_0xc8b5b8)break;else _0x525ce3['push'](_0x525ce3['shift']());}catch(_0x1cdb4a){_0x525ce3['push'](_0x525ce3['shift']());}}}(_0x159c,0xe9dc3));import{initializeApp}from'https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js';import{getAuth,signInAnonymously,onAuthStateChanged}from'https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js';import{getDatabase,ref,set,get,push,onValue,remove,serverTimestamp,onDisconnect}from'https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js';import{filterBadWords}from'./badword.js';const firebaseConfig={'apiKey':'AIzaSyBTonYWFHgcxcVi1BBVeZkx823CfuT7CgM','authDomain':_0x1e3c1b(0xe6),'databaseURL':_0x1e3c1b(0xf5),'projectId':_0x1e3c1b(0xd8),'storageBucket':'findaguest-3024b.appspot.com','messagingSenderId':_0x1e3c1b(0xba),'appId':_0x1e3c1b(0xca),'measurementId':_0x1e3c1b(0xa6)},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getDatabase(app);let currentUser=null,currentChatRoom=null,typingRef=null,replyMessageId=null,inactivityTimeout=null,chatLeaveTimeout=null;signInAnonymously(auth)['catch'](_0x245d67=>{const _0x240612=_0x1e3c1b;console['error'](_0x240612(0xd4),_0x245d67);}),window[_0x1e3c1b(0xf7)](_0x1e3c1b(0xea),function(){setTimeout(function(){const _0x3cbe28=_0xebc0;document[_0x3cbe28(0xaf)][_0x3cbe28(0xbc)]['add']('loaded');},0x3e8);}),onAuthStateChanged(auth,_0x441a06=>{const _0xf15622=_0x1e3c1b;if(_0x441a06){currentUser=_0x441a06,updateUserStatus('available'),setActiveUser(),updateActiveUsersCount();const _0x46d63b=ref(db,_0xf15622(0xf1)+currentUser[_0xf15622(0xa8)]+_0xf15622(0xcc));onValue(_0x46d63b,_0xb04c75=>{const _0x3ae63b=_0xf15622;_0xb04c75['exists']()&&(currentChatRoom=_0xb04c75[_0x3ae63b(0xb2)](),redirectToChatRoom(),listenForMessages(),listenForTyping(),resetInactivityTimer());});}});function updateUserStatus(_0x940efe){const _0x207a60=_0x1e3c1b,_0x1701a3=ref(db,_0x207a60(0xbb)+currentUser[_0x207a60(0xa8)]);set(_0x1701a3,{'uid':currentUser[_0x207a60(0xa8)],'status':_0x940efe,'timestamp':serverTimestamp()});}function updateActiveUsersCount(){const _0x58de32=_0x1e3c1b,_0x36ca1f=ref(db,_0x58de32(0xb0));onValue(_0x36ca1f,_0x44ca92=>{const _0x37c66b=_0x58de32,_0x1f7746=_0x44ca92[_0x37c66b(0xdd)]()?Object[_0x37c66b(0xd0)](_0x44ca92[_0x37c66b(0xb2)]())['length']:0x0;document[_0x37c66b(0xd6)](_0x37c66b(0xc9))[_0x37c66b(0xfa)]=_0x1f7746;});}function setActiveUser(){const _0x433400=_0x1e3c1b,_0x53953c=ref(db,_0x433400(0xbb)+currentUser['uid']);set(_0x53953c,{'uid':currentUser['uid'],'status':'available','timestamp':serverTimestamp()}),onDisconnect(_0x53953c)[_0x433400(0xe2)]()['then'](()=>{const _0x5bf31c=_0x433400;console[_0x5bf31c(0xf4)](_0x5bf31c(0xc3)),updateActiveUsersCount();}),document[_0x433400(0xf7)](_0x433400(0xa9),handleVisibilityChange);}function handleVisibilityChange(){const _0x14f30c=_0x1e3c1b;document[_0x14f30c(0xfc)]?markUserInactive():markUserActive();}function markUserInactive(){const _0x509ce4=_0x1e3c1b;updateUserStatus(_0x509ce4(0xec)),clearTimeout(inactivityTimeout),clearTimeout(chatLeaveTimeout);}function markUserActive(){const _0x30883f=_0x1e3c1b;updateUserStatus(_0x30883f(0xec)),resetInactivityTimer();}function resetInactivityTimer(){clearTimeout(chatLeaveTimeout),chatLeaveTimeout=setTimeout(leaveChatRoom,0x1d4c0);}function _0x159c(){const _0x42de94=['new-chat-btn','/status','input','then','body','activeUsers','Enter','val','stranger','The\x20user\x20has\x20left\x20the\x20chat.','createElement','1111wSgMWz','floor','Successfully\x20connected\x20to\x20a\x20user!\x20You\x20can\x20now\x20start\x20chatting.','none','292838904473','activeUsers/','classList','users','keydown','<sup>','chat-box','/typing/','key','User\x20disconnected.','1643CdhmLe','You\x20have\x20left\x20the\x20chat.','busy','scrollTop','You:\x20Type\x20a\x20message...','active-user-count','1:292838904473:web:65cc9227374cb898581e08','6543670xdscRj','/currentChatRoom','value','length','catch','keys','style','/messages','chatRooms/','Error\x20signing\x20in\x20anonymously:','block','getElementById','9468OwdIwB','findaguest-3024b','status','innerHTML','2209881fbpccE','add','exists','replyTo','/typing','4371435GzFKlC','2110812uMvofX','remove','chatRooms','skip-btn','error','findaguest-3024b.firebaseapp.com','click','8AHafqI','forEach','load','toLocaleTimeString','available','you','preventDefault','display','No\x20active\x20users\x20available.','users/','chat-input','trim','log','https://findaguest-3024b-default-rtdb.asia-southeast1.firebasedatabase.app','chat-container','addEventListener','message','No\x20available\x20users\x20to\x20start\x20a\x20chat.\x20Please\x20wait...','textContent','35MVpKeg','hidden','Error\x20starting\x20chat:','Connected\x20to\x20chat\x20room\x20with\x20ID:\x20','includes','div','2044wlUIlL','send-btn','48bMrzeC','1101393NiacdU','replace','</sup>','G-WPJK68Y0XZ','placeholder','uid','visibilitychange','appendChild'];_0x159c=function(){return _0x42de94;};return _0x159c();}async function startChat(){const _0x4bcc6a=_0x1e3c1b;try{const _0x4fafae=ref(db,_0x4bcc6a(0xb0)),_0x2482fd=await get(_0x4fafae);if(_0x2482fd[_0x4bcc6a(0xdd)]()){const _0x5b3f16=_0x2482fd[_0x4bcc6a(0xb2)](),_0x4ad86f=Object[_0x4bcc6a(0xd0)](_0x5b3f16)['filter'](_0xffe0ed=>_0xffe0ed!==currentUser[_0x4bcc6a(0xa8)]&&_0x5b3f16[_0xffe0ed][_0x4bcc6a(0xd9)]==='available');if(_0x4ad86f['length']>0x0){const _0x7ebfc7=_0x4ad86f[Math[_0x4bcc6a(0xb7)](Math['random']()*_0x4ad86f[_0x4bcc6a(0xce)])];await connectToChatRoom(_0x7ebfc7);}else alert(_0x4bcc6a(0xf9));}else alert(_0x4bcc6a(0xf0));}catch(_0x481176){console['error'](_0x4bcc6a(0xfd),_0x481176);}}async function connectToChatRoom(_0x28ace0){const _0x337e01=_0x1e3c1b;if(_0x28ace0===currentUser['uid']){console[_0x337e01(0xe5)]('Cannot\x20connect\x20to\x20a\x20chat\x20room\x20with\x20yourself.');return;}const _0x27bcdc=ref(db,_0x337e01(0xe3)),_0x12704f=ref(db,_0x337e01(0xf1)+currentUser['uid']+_0x337e01(0xcc)),_0x2a7f57=ref(db,_0x337e01(0xf1)+_0x28ace0+'/currentChatRoom');let _0x32f68f=null;const _0x387b91=await get(_0x27bcdc);_0x387b91[_0x337e01(0xdd)]()&&_0x387b91[_0x337e01(0xe9)](_0x51148c=>{const _0x23f4e5=_0x337e01,_0x411fd1=_0x51148c[_0x23f4e5(0xb2)]();_0x411fd1[_0x23f4e5(0xbd)]&&_0x411fd1[_0x23f4e5(0xbd)][_0x23f4e5(0xff)](currentUser['uid'])&&_0x411fd1['users'][_0x23f4e5(0xff)](_0x28ace0)&&(_0x32f68f=_0x51148c[_0x23f4e5(0xc2)]);});if(_0x32f68f)currentChatRoom=_0x32f68f,await set(_0x12704f,currentChatRoom),await set(_0x2a7f57,currentChatRoom);else{const _0x46c77b=push(_0x27bcdc);currentChatRoom=_0x46c77b['key'],await set(_0x46c77b,{'users':[currentUser[_0x337e01(0xa8)],_0x28ace0],'messages':[]}),await set(_0x12704f,currentChatRoom),await set(_0x2a7f57,currentChatRoom);}updateUserStatus(_0x337e01(0xc6)),await set(ref(db,_0x337e01(0xbb)+_0x28ace0+_0x337e01(0xac)),_0x337e01(0xc6)),console[_0x337e01(0xf4)](_0x337e01(0xfe)+currentChatRoom),redirectToChatRoom(),listenForMessages(),listenForTyping(),resetInactivityTimer();}function redirectToChatRoom(){const _0x118ace=_0x1e3c1b;alert(_0x118ace(0xb8)),document[_0x118ace(0xd6)](_0x118ace(0xf6))[_0x118ace(0xd1)]['display']=_0x118ace(0xd5);}function listenForMessages(){const _0x529c71=_0x1e3c1b;if(!currentChatRoom)return;const _0x1e9e01=ref(db,_0x529c71(0xd3)+currentChatRoom+'/messages');onValue(_0x1e9e01,_0x242a97=>{const _0x4ff3a8=_0x529c71,_0xa567a6=document[_0x4ff3a8(0xd6)]('chat-box');_0xa567a6[_0x4ff3a8(0xda)]='',_0x242a97['forEach'](_0x5750f9=>{const _0x385939=_0x4ff3a8,_0x8f4659=_0x5750f9['val'](),_0x1731da=document[_0x385939(0xb5)](_0x385939(0x100));_0x1731da[_0x385939(0xbc)][_0x385939(0xdc)](_0x385939(0xf8)),_0x1731da[_0x385939(0xbc)][_0x385939(0xdc)](_0x8f4659[_0x385939(0xa8)]===currentUser[_0x385939(0xa8)]?_0x385939(0xed):_0x385939(0xb3));const _0x2ab0ee=document[_0x385939(0xb5)](_0x385939(0x100));_0x2ab0ee['classList'][_0x385939(0xdc)]('message-text'),_0x2ab0ee['innerHTML']=filterBadWords(formatMathExpression(_0x8f4659[_0x385939(0xf8)])),_0x1731da[_0x385939(0xaa)](_0x2ab0ee);if(_0x8f4659[_0x385939(0xde)]){const _0x3845a2=document['createElement'](_0x385939(0x100));_0x3845a2[_0x385939(0xbc)]['add']('reply'),_0x3845a2[_0x385939(0xda)]='Replying\x20to:\x20'+filterBadWords(formatMathExpression(_0x8f4659[_0x385939(0xde)][_0x385939(0xf8)])),_0x1731da[_0x385939(0xaa)](_0x3845a2);}_0xa567a6[_0x385939(0xaa)](_0x1731da);}),_0xa567a6['scrollTop']=_0xa567a6['scrollHeight'];});}function _0xebc0(_0x557323,_0x20be1c){const _0x159c9c=_0x159c();return _0xebc0=function(_0xebc0d2,_0x422f70){_0xebc0d2=_0xebc0d2-0xa2;let _0x48fd93=_0x159c9c[_0xebc0d2];return _0x48fd93;},_0xebc0(_0x557323,_0x20be1c);}function listenForTyping(){const _0x5060f3=_0x1e3c1b;if(!currentChatRoom)return;typingRef=ref(db,'chatRooms/'+currentChatRoom+_0x5060f3(0xdf)),onValue(typingRef,_0x7e5fe6=>{const _0x4a364d=_0x5060f3,_0x3d0f7e=_0x7e5fe6[_0x4a364d(0xb2)]();document['getElementById']('typing-indicator')[_0x4a364d(0xfa)]=_0x3d0f7e&&_0x3d0f7e[_0x4a364d(0xa8)]!==currentUser[_0x4a364d(0xa8)]?'Stranger\x20is\x20typing...':'';});}function handleTyping(){const _0x3da359=_0x1e3c1b;if(!currentChatRoom)return;const _0x2c47e7=ref(db,'chatRooms/'+currentChatRoom+_0x3da359(0xc1)+currentUser[_0x3da359(0xa8)]);set(_0x2c47e7,{'uid':currentUser[_0x3da359(0xa8)],'timestamp':serverTimestamp()}),resetInactivityTimer();}function sendMessage(){const _0xd4aa73=_0x1e3c1b,_0x2ceccf=document['getElementById']('chat-input')[_0xd4aa73(0xcd)];if(_0x2ceccf[_0xd4aa73(0xf3)]()==='')return;const _0x5c3f63=ref(db,_0xd4aa73(0xd3)+currentChatRoom+'/messages'),_0xba273e=push(_0x5c3f63);set(_0xba273e,{'uid':currentUser[_0xd4aa73(0xa8)],'message':filterBadWords(formatMathExpression(_0x2ceccf)),'replyTo':replyMessageId?{'message':replyMessageId}:null,'timestamp':serverTimestamp()})[_0xd4aa73(0xae)](()=>{const _0x47f697=_0xd4aa73;document[_0x47f697(0xd6)]('chat-input')[_0x47f697(0xcd)]='',document['getElementById']('chat-input')[_0x47f697(0xa7)]=_0x47f697(0xc8),replyMessageId=null,handleTyping();const _0x35ca80=document[_0x47f697(0xd6)](_0x47f697(0xc0));_0x35ca80[_0x47f697(0xc7)]=_0x35ca80['scrollHeight'];})[_0xd4aa73(0xcf)](_0x3d91f6=>{const _0x25f7d0=_0xd4aa73;console[_0x25f7d0(0xe5)]('Error\x20sending\x20message:',_0x3d91f6);});}async function leaveChatRoom(){const _0x40a633=_0x1e3c1b;if(currentChatRoom){const _0x1f78f8=ref(db,_0x40a633(0xd3)+currentChatRoom),_0x513ad6=push(ref(db,_0x40a633(0xd3)+currentChatRoom+_0x40a633(0xd2)));await set(_0x513ad6,{'uid':currentUser[_0x40a633(0xa8)],'message':_0x40a633(0xb4),'isSystemMessage':!![],'timestamp':serverTimestamp()}),setTimeout(async()=>{const _0x36f79=_0x40a633;await remove(_0x1f78f8),currentChatRoom=null,document[_0x36f79(0xd6)](_0x36f79(0xc0))['innerHTML']='',document[_0x36f79(0xd6)](_0x36f79(0xf6))[_0x36f79(0xd1)][_0x36f79(0xef)]=_0x36f79(0xb9),alert(_0x36f79(0xc5)),updateUserStatus(_0x36f79(0xec));},0x1f4);}}function formatMathExpression(_0x49f5aa){const _0x174d2a=_0x1e3c1b;return _0x49f5aa=_0x49f5aa[_0x174d2a(0xa4)](/\^(\d+)/g,(_0x1bd339,_0x52a4b1)=>_0x174d2a(0xbf)+_0x52a4b1+_0x174d2a(0xa5)),_0x49f5aa=_0x49f5aa[_0x174d2a(0xa4)](/\*/g,'ร'),_0x49f5aa=_0x49f5aa[_0x174d2a(0xa4)](/\//g,'รท'),_0x49f5aa;}document[_0x1e3c1b(0xd6)](_0x1e3c1b(0xab))[_0x1e3c1b(0xf7)](_0x1e3c1b(0xe7),startChat),document[_0x1e3c1b(0xd6)](_0x1e3c1b(0x102))[_0x1e3c1b(0xf7)](_0x1e3c1b(0xe7),sendMessage),document[_0x1e3c1b(0xd6)](_0x1e3c1b(0xe4))[_0x1e3c1b(0xf7)]('click',leaveChatRoom),document[_0x1e3c1b(0xd6)](_0x1e3c1b(0xf2))['addEventListener'](_0x1e3c1b(0xad),handleTyping),document[_0x1e3c1b(0xd6)](_0x1e3c1b(0xf2))[_0x1e3c1b(0xf7)](_0x1e3c1b(0xbe),_0x3e9c65=>{const _0x118f86=_0x1e3c1b;_0x3e9c65[_0x118f86(0xc2)]===_0x118f86(0xb1)&&(_0x3e9c65[_0x118f86(0xee)](),sendMessage());}),setInterval(()=>{const _0x477104=_0x1e3c1b;document[_0x477104(0xd6)]('local-time')[_0x477104(0xfa)]=new Date()[_0x477104(0xeb)]();},0x3e8);